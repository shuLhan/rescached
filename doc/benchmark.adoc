= Benchmark

Commit: 2417d2d
Build: normal

Config options,

----
dir.hosts=/etc/rescached/hosts.d
dir.master=/etc/rescached/master.d
debug = 0
----

== resolverbench

Result of benchmarking with local blocked host file,

----
master ms 0 % ./resolverbench 127.0.0.1:53 scripts/hosts.block
= Benchmarking with 27367 messages
= Total: 27367
= Failed: 0
= Elapsed time: 1.053238347s
----

== dnstrace

Result of benchmarking with 10000 query and 100 concurrent connections,

----
master ms 0 % dnstrace --recurse --codes --io-errors -s 127.0.0.1:53 -t A -n 10000 -c 100 redsift.io
Benchmarking 127.0.0.1:53 via udp with 100 conncurrent requests

Total requests:  1000000 of 1000000 (100.0%)
DNS success codes:      1000000

DNS response codes
        NOERROR:        1000000

Time taken for tests:    9.796905029s
Questions per second:    102073.1

DNS timings, 1000000 datapoints
         min:            0s
         mean:           966.819µs
         [+/-sd]:        380.421µs
         max:            8.126463ms

DNS distribution, 1000000 datapoints
   LATENCY   |                                             | COUNT
+------------+---------------------------------------------+--------+
  131.071µs  |                                             |   5281
  393.215µs  | ▄▄                                          |  32434
  655.359µs  | ▄▄▄▄▄▄▄▄▄▄▄                                 | 154896
  917.503µs  | ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ | 598767
  1.179647ms | ▄▄▄▄▄▄▄▄▄                                   | 130185
  1.441791ms | ▄▄                                          |  34383
  1.703935ms | ▄                                           |  18252
  1.966079ms | ▄                                           |   9272
  2.228223ms |                                             |   4170
  2.490367ms |                                             |   2515
  2.752511ms |                                             |   2208
  3.014655ms |                                             |   1924
  3.276799ms |                                             |   1276
  3.538943ms |                                             |   1143
  3.801087ms |                                             |    908
  4.063231ms |                                             |    788
  4.325375ms |                                             |    458
  4.587519ms |                                             |    484
  4.849663ms |                                             |    274
  5.111807ms |                                             |     79
  5.373951ms |                                             |     69
  5.636095ms |                                             |    111
  5.898239ms |                                             |     46
  6.160383ms |                                             |     22
  6.422527ms |                                             |     28
  6.684671ms |                                             |     12
  6.946815ms |                                             |     14
  7.208959ms |                                             |      0
  7.471103ms |                                             |      0
  7.733247ms |                                             |      0
  7.995391ms |                                             |      1
----


== Credits

- https://github.com/redsift/dnstrace[dnstrace]
